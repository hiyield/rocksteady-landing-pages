<!--
  templateType: blog_post
  isAvailableForNewContent: true
  label: Boilerplate - blog post
  screenshotPath: ../images/template-previews/blog-post.png
-->
{% set template_css = "../../css/templates/blog.css" %}
{% extends "./layouts/base.html" %}

{% block body %}
<div class="body-container body-container--blog-post">

  {# Blog post #}
  <div class="content-wrapper">
    <article class="hy-blog-post">
      {% module "blog_title" path="../modules/blog-title", label="Blog Title", no_wrapper=True %}

      {% module "key_takeaways" path="../modules/key-takeaways", label="Key Takeaways", no_wrapper=True %}

      {# Meta section #}
      <div class="hy-blog-post__meta hy-prose-container">
        <div class="hy-author-date-container">
          {% if content.publish_date %}
          <time datetime="{{ content.publish_date }}" class="blog-post__timestamp"> 
            {{ content.publishDate|datetimeformat('%e %B %Y') }} 
          </time>
          {% endif %}
          
          <span class="hy-author-date-seperator">|</span>
          
          <span>
            By
            <a href="{{ blog_author_url(group.id, content.blog_post_author.slug)|escape_url }}" rel="author">
              {{ content.blog_post_author.display_name|escape_html }}
            </a>
          </span>
        </div>

        {% if content.url %}
        <div class="hy-share-container desktop">
          <span>Share:</span>
          <div class="hy-social-links">
            {% if content.title %}
            <a class="hy-social-links__link" href="https://www.facebook.com/sharer/sharer.php?u={{ content.url }}&t={{ content.title }}" target="_blank" rel="noopener">
              {% icon extra_classes="hy-social-links__icon", name="facebook", icon_set="fontawesome-6.4.2", purpose="semantic", style="SOLID", title="Facebook Icon", unique_in_loop=True %}
            </a>

            <a class="hy-social-links__link" href="https://x.com/intent/tweet?text={{ content.title }}&url={{ content.url }}" target="_blank" rel="noopener">
              {% icon extra_classes="hy-social-links__icon", name="x-twitter", icon_set="fontawesome-6.4.2", purpose="semantic", style="SOLID", title="X Icon", unique_in_loop=True %}
            </a>
            {% endif %}

            <a class="hy-social-links__link" href="https://www.linkedin.com/sharing/share-offsite/?url={{ content.url }}" target="_blank" rel="noopener">
              {% icon extra_classes="hy-social-links__icon", name="linkedin", icon_set="fontawesome-6.4.2", purpose="semantic", style="SOLID", title="LinkedIn Icon", unique_in_loop=True %}
            </a>
          </div>
        </div>
        {% endif %}

        <div class="hy-seperator"></div>
      </div>

      {# Blog body #}
      {% if content.post_body %}
      <div class="hy-blog-post__body hy-prose-container">
        {{ content.post_body }}
      </div>
      {% endif %}

      {% if content.url %}
        <div class="hy-prose-container hy-share-container mobile">
          <span>Share this article:</span>
          <div class="hy-social-links">
            {% if content.title %}
            <a class="hy-social-links__link" href="https://www.facebook.com/sharer/sharer.php?u={{ content.url }}&t={{ content.title }}" target="_blank" rel="noopener">
              {% icon extra_classes="hy-social-links__icon", name="facebook", icon_set="fontawesome-6.4.2", purpose="semantic", style="SOLID", title="Facebook Icon", unique_in_loop=True %}
            </a>

            <a class="hy-social-links__link" href="https://x.com/intent/tweet?text={{ content.title }}&url={{ content.url }}" target="_blank" rel="noopener">
              {% icon extra_classes="hy-social-links__icon", name="x-twitter", icon_set="fontawesome-6.4.2", purpose="semantic", style="SOLID", title="X Icon", unique_in_loop=True %}
            </a>
            {% endif %}

            <a class="hy-social-links__link" href="https://www.linkedin.com/sharing/share-offsite/?url={{ content.url }}" target="_blank" rel="noopener">
              {% icon extra_classes="hy-social-links__icon", name="linkedin", icon_set="fontawesome-6.4.2", purpose="semantic", style="SOLID", title="LinkedIn Icon", unique_in_loop=True %}
            </a>
          </div>
        </div>
        {% endif %}

    </article>
  </div>

  <section class="hy-blog-related-posts content-wrapper">
      
  <div class="hy-blog-related-posts__slant"></div>
  
  <div class="hy-blog-related-posts__container">
    <h2 class="hy-blog-related-posts__title">See more like this</h2>
    <div class="hy-blog-related-posts__list">

      {# Step 1: Fetch the 5 most recent posts from this blog #}
      {% set recent_posts_list = blog_recent_posts(group.id, 5) %}

      {# Step 2: Loop through the list, but filter out the current post being viewed #}
      {% for post in recent_posts_list if post.content_id != content.id %}

          {# Step 3: Render the HTML for each post. The loop will automatically limit itself to 4 posts. #}
          <a href="{{ post.absolute_url|escape_url }}" class="hy-blog-related-posts__post" aria-label="Blog post summary: {{ post.name|escape_attr }}">
            {% if post.featured_image %}
              <div class="hy-blog-related-posts__post-image-wrapper">
                <img class="hy-blog-related-posts__image" src="{{ post.featured_image|escape_url }}" loading="lazy" width="352" alt="{{ post.featured_image_alt_text|escape_attr }}">
              </div>
            {% endif %}
            <div class="hy-blog-related-posts__content">
              <h3 class="hy-blog-related-posts__post-title">
                {{ post.name|escape }}
              </h3>
              <p class="hy-blog-related-posts__date">{{ post.publish_date|datetimeformat('%e %B %Y') }}</p>
              <span class="hy-button hy-button-purple">Read article</span>
            </div>
          </a>
        
      {% endfor %}
      
    </div>
  </div>

</section>

</div>
{% endblock body %}
